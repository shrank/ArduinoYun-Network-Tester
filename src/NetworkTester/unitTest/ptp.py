import time
import unittest
import sys
sys.path.insert(0,"../")
from tests import Audio, result

class TestStatusPkt(unittest.TestCase):

	def test_parseLong(self):
		data="\x00\x01\x00\x01\x5f\x44\x46\x4c\x54\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x1d\xc1\x0e\xff\xac\x00\x01\x00\xff\x00\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x06\x18\x29\x42\xcb\x54\x00\x00\x00\x00\x00\x01\x00\x1d\xc1\x0e\xff\xac\x00\x00\x00\xff\x00\x00\x00\x79\x44\x46\x4c\x54\xff\xff\xf0\x60\x00\x00\x00\x01\xff\xff\xff\xfe\xff\xff\xf0\x60\x00\x00\x00\x00\x00\x00\x00\x79\x44\x46\x4c\x54\x00\x01\x00\x1d\xc1\x0e\xff\xac\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
		a=Audio.testPTP()
		a.read(data,["192.168.1.1",1039])
		self.assertTrue(a.test()==result.OK)
		time.sleep(1.1)
		self.assertTrue(a.test()==result.FAIL)
		time.sleep(1.1)
		self.assertTrue(a.test()==result.OFF)
		a.read(data,["192.168.1.1",1039])
		self.assertTrue(a.test()==result.OK)
		a.read(data,["192.168.1.2",1039])
		self.assertTrue(a.test()==result.WARN)
		time.sleep(1.1)
		a.read(data,["192.168.1.2",1039])
		self.assertTrue(a.test()==result.OK)


	def test_parse2(self):
		data="\x00\x01\x00\x01\x5f\x44\x46\x4c\x54\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x1d\xc1\x0e\xff\xac\x00\x01\x1d\xed\x00\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x0d\x8a\x33\xf0\x82\x80\x00\x00\x00\x00\x00\x01\x00\x1d\xc1\x0e\xff\xac\x00\x00\x1d\xed\x00\x00\x00\x79\x44\x46\x4c\x54\xff\xff\xf0\x60\x00\x00\x00\x01\xff\xff\xff\xfe\xff\xff\xf0\x60\x00\x00\x00\x00\x00\x00\x00\x79\x44\x46\x4c\x54\x00\x01\x00\x1d\xc1\x0e\xff\xac\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
		a=Audio.testPTP()
		a.read(data,["192.168.1.1",1039])
		a.read(data,["192.168.1.1",1039])

	def test_DelayRequest(self):
		data="\x00\x01\x00\x01\x5f\x44\x46\x4c\x54\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x1d\xc1\x0b\xd2\x1a\x00\x01\x00\x2a\x01\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x01\x07\x09\xd0\xbd\xe7\x00\x00\x00\x00\x00\x01\x00\x1d\xc1\x0b\xd3\x10\x00\x00\x01\xf3\x00\x00\x00\x79\x44\x46\x4c\x54\xff\xff\xf0\x60\x00\x00\x00\x01\xff\xff\xff\xfe\xff\xff\xf0\x60\x00\x00\x00\x01\x00\x00\x00\x7b\x44\x46\x4c\x54\x00\x01\x00\x1d\xc1\x0b\xd3\x10\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
		a=Audio.testPTP()
		a.read(data,["192.168.1.2",1039])
		print(a.test())
		self.assertTrue(a.test()<=result.OFF)




if __name__ == '__main__':
    unittest.main()
